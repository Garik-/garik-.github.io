<!DOCTYPE html><html lang="ru"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta name="robots" content="index,noarchive,follow,max-image-preview:large"><meta name="referrer" content="unsafe-url"><link rel="stylesheet" href="/stylesheets/style.d0b9e4490a.css"><link rel="icon" href="/images/favicon.ico"><link rel="apple-touch-icon" href="/images/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><script src="/javascripts/counter.js" async></script><title>MQ metrics &amp; alerts | by Igor Riakhovskii</title><meta name="title" content="MQ metrics &amp; alerts | by Igor Riakhovskii"><meta name="description" content="На что стоит обратить внимание
"><meta property="og:title" content="MQ metrics &amp; alerts"><meta property="og:description" content="На что стоит обратить внимание
"><meta property="og:url" content="https://gariktalksabout.tech/mq-metrics-alerts.html"><meta property="og:site_name" content="Igor Riakhovskii"><meta property="og:type" content="article"><meta property="og:image" content="https://gariktalksabout.tech/v1/resize:fit:1200/mq-alerts.webp"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="686"><meta property="article:published_time" content="2024-12-28T00:32:11+03:00"><meta property="article:modified_time" content="2025-01-13T01:22:15+03:00"><meta property="profile:first_name" content="Igor"><meta property="profile:last_name" content="Riakhovskii"><meta property="profile:username" content="garikdjan"><meta property="article:tag" content="MQ"><meta property="article:tag" content="DevOps"><meta property="article:tag" content="Observability"><meta property="article:tag" content="Note"><link rel="author" href="https://gariktalksabout.tech/"><link rel="canonical" href="https://gariktalksabout.tech/mq-metrics-alerts.html"><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","url":"https://gariktalksabout.tech/mq-metrics-alerts.html","dateCreated":"2024-12-28T00:32:11+03:00","datePublished":"2024-12-28T00:32:11+03:00","dateModified":"2025-01-13T01:22:15+03:00","headline":"MQ metrics & alerts","name":"MQ metrics & alerts","description":"На что стоит обратить внимание\n","identifier":71790839,"author":{"@type":"Person","name":"Igor Riakhovskii","url":"https://gariktalksabout.tech/"},"creator":["Igor Riakhovskii"],"mainEntityOfPage":"https://gariktalksabout.tech/mq-metrics-alerts.html","image":["https://gariktalksabout.tech/v1/resize:fit:1200/mq-alerts.webp"]}</script><script src="/javascripts/header.js" defer></script></head><body><header class="header-panel"><div class="header-panel-wrap"><a class="header-panel-logo" href="/" rel="noopener follow">IR</a></div></header><main class="article-layout"><div class="container"><article><h1 class="post-title">MQ metrics &amp; alerts</h1><section class="post-info"><a class="author-photo-link" rel="noopener follow" href="/"><img class="author-photo" alt="Igor Riakhovskii" src="/v1/resize:fill:88:88/public/avatar.jpg" width="44" height="44" loading="lazy"><div class="author-photo-shadow"></div></a><div class="post-info-author"><a class="author-name" rel="noopener follow" href="/">Igor Riakhovskii</a><div class="post-info-date"><span>1 min read</span><span class="separator">·</span><span>Dec 28, 2024</span></div></div></section><div class="post-content">
  <figure>
    <picture>
        <source srcset="/v1/resize:fit:640/format:webp/mq-alerts.webp 640w, /v1/resize:fit:720/format:webp/mq-alerts.webp 720w, /v1/resize:fit:750/format:webp/mq-alerts.webp 750w, /v1/resize:fit:768/format:webp/mq-alerts.webp 768w, /v1/resize:fit:828/format:webp/mq-alerts.webp 828w, /v1/resize:fit:1100/format:webp/mq-alerts.webp 1100w, /v1/resize:fit:1400/format:webp/mq-alerts.webp 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp">
        <source srcset="/v1/resize:fit:640/mq-alerts.webp 640w, /v1/resize:fit:720/mq-alerts.webp 720w, /v1/resize:fit:750/mq-alerts.webp 750w, /v1/resize:fit:768/mq-alerts.webp 768w, /v1/resize:fit:828/mq-alerts.webp 828w, /v1/resize:fit:1100/mq-alerts.webp 1100w, /v1/resize:fit:1400/mq-alerts.webp 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px">
        <img alt="" width="1400" height="800" loading="lazy" role="presentation" src="/v1/resize:fit:1400/mq-alerts.webp">
    </picture>
    
  </figure>
  
<p>На что стоит обратить внимание</p>
<h1 id="metrics">Metrics</h1>
<ul>
<li>Размер очереди</li>
<li>Поток сообщений</li>
<li>мониторить надо количество не акнутых сообщений</li>
<li>мониторить надо время - полной обработки сообщения, время исполнения консьюмера</li>
<li>количество повторов/потерь/отказов</li>
</ul>
<h1 id="alerts">Alerts</h1>
<ul>
<li>Если больше 80% заполненность диска</li>
<li>Если больше 80% заполненность памяти</li>
<li>Если Размер очереди больше 1000мб.</li>
<li>Поток сообщений в течении 3минут больше 20</li>
<li>Разница между поступающими сообщениями и обработанными в течении 3х минут и она больше 100 то слать алерт</li>
<li>Кол-во ожидающих обработки ACT  сообщений больше 10 в течении 5 минут</li>
<li>Кол-во повторов больше 10 в течении 5 минут</li>
<li>Процент: Если больше 50% повторных доставкок сообщений потребителем Nats</li>
</ul></div></article><div class="post-tags"><div class="topics-list"><div class="topic-item"><a class="topic-item-link" rel="noopener follow" href="/tag/mq.html"><div class="topic-item-text">MQ</div></a></div><div class="topic-item"><a class="topic-item-link" rel="noopener follow" href="/tag/devops.html"><div class="topic-item-text">DevOps</div></a></div><div class="topic-item"><a class="topic-item-link" rel="noopener follow" href="/tag/observability.html"><div class="topic-item-text">Observability</div></a></div><div class="topic-item"><a class="topic-item-link" rel="noopener follow" href="/tag/note.html"><div class="topic-item-text">Note</div></a></div></div></div></div></main><footer class="article-footer"><div class="container"><div class="content"><div class="space"></div><section class="author-section"><a class="author-section-left" rel="noopener follow" href="/"><div class="avatar-box"><img class="avatar mobile-hide" alt="Igor Riakhovskii" src="/v1/resize:fill:96:96/public/avatar.jpg" width="48" height="48" loading="lazy"><div class="avatar-shadow mobile-hide"></div><img class="avatar-big mobile-only" alt="Igor Riakhovskii" src="/v1/resize:fill:128:128/public/avatar.jpg" width="64" height="64" loading="lazy"><div class="avatar-big-shadow mobile-only"></div></div></a><div><a class="author-name" rel="noopener follow" href="/">Written by Igor Riakhovskii</a><div class="author-summary">In commercial development since 2005. At the moment, I am engaged in product development of cloud systems in the role of Technical Lead</div></div></section></div></div></footer></body></html>